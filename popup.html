<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Textorium</title>
  <style>
    :root {
      --bg: #f4f6f2;
      --panel: #ffffff;
      --panel-soft: #f9faf7;
      --text: #182022;
      --muted: #5d6764;
      --line: #cfd6d3;
      --accent: #0f766e;
      --accent-soft: #e7f3f1;
      --danger: #b42318;
      --danger-soft: #fef0ed;
      --radius: 12px;
      --shadow: 0 8px 22px rgba(13, 32, 27, 0.08);
      --font-ui: "Noto Sans JP", "Hiragino Sans", "Yu Gothic UI", sans-serif;
    }
    body.dark-mode {
      --bg: #101312;
      --panel: #1a1f1d;
      --panel-soft: #111715;
      --text: #e5ecea;
      --muted: #9fb0ab;
      --line: #35433f;
      --accent: #38b2a7;
      --accent-soft: #15322f;
      --danger: #ff6a5f;
      --danger-soft: #3f1b17;
      --shadow: 0 12px 28px rgba(0, 0, 0, 0.35);
    }
    * {
      box-sizing: border-box;
    }
    html,
    body {
      width: 400px;
      min-width: 400px;
      max-width: 400px;
      overflow-x: hidden;
    }
    body {
      margin: 0;
      padding: 12px;
      max-height: 600px;
      overflow-y: auto;
      font-family: var(--font-ui);
      background:
        radial-gradient(140px 100px at right -20px top -12px, rgba(15, 118, 110, 0.12), transparent),
        var(--bg);
      color: var(--text);
    }
    .app {
      display: grid;
      gap: 10px;
      min-width: 0;
    }
    .topbar {
      position: sticky;
      top: 0;
      z-index: 10;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 8px;
      padding: 10px;
      border: 1px solid var(--line);
      border-radius: var(--radius);
      background: color-mix(in srgb, var(--panel) 92%, transparent);
      box-shadow: var(--shadow);
      backdrop-filter: blur(4px);
    }
    .brand {
      display: flex;
      align-items: baseline;
      gap: 8px;
    }
    .brand h1 {
      margin: 0;
      font-size: 1.1rem;
      letter-spacing: 0.04em;
    }
    .brand small {
      color: var(--muted);
      font-size: 0.7rem;
    }
    .toolbar {
      display: flex;
      gap: 6px;
      align-items: center;
      flex-wrap: wrap;
      justify-content: flex-end;
    }
    .section {
      border: 1px solid var(--line);
      border-radius: var(--radius);
      background: var(--panel);
      padding: 10px;
      box-shadow: var(--shadow);
    }
    .section h2 {
      margin: 0 0 8px;
      font-size: 0.9rem;
    }
    .section summary {
      cursor: pointer;
      list-style: none;
      font-size: 0.9rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin: -2px 0 8px;
    }
    .section summary::-webkit-details-marker {
      display: none;
    }
    .section summary::after {
      content: "â–¾";
      font-size: 0.78rem;
      color: var(--muted);
    }
    .section:not([open]) summary {
      margin-bottom: 0;
    }
    .section:not([open]) summary::after {
      content: "â–¸";
    }
    .grid {
      display: grid;
      gap: 8px;
    }
    .grid.two {
      grid-template-columns: 1fr 1fr;
    }
    label {
      font-size: 0.78rem;
      color: var(--muted);
      font-weight: 600;
    }
    input, textarea, select, button {
      width: 100%;
      min-width: 0;
      font: inherit;
      border-radius: 9px;
      border: 1px solid var(--line);
      background: var(--panel-soft);
      color: var(--text);
      padding: 8px 9px;
    }
    textarea {
      min-height: 90px;
      resize: vertical;
    }
    button {
      cursor: pointer;
      transition: background-color 120ms ease, border-color 120ms ease;
    }
    button:hover {
      border-color: var(--accent);
    }
    .btn-primary {
      border-color: var(--accent);
      background: var(--accent-soft);
      font-weight: 700;
    }
    .btn-ghost {
      background: transparent;
    }
    .inline-actions {
      display: grid;
      gap: 6px;
      grid-template-columns: repeat(3, 1fr);
    }
    .status-message {
      border: 1px solid var(--line);
      border-radius: 9px;
      padding: 7px 9px;
      font-size: 0.82rem;
    }
    .status-message.info {
      background: var(--accent-soft);
      color: var(--accent);
    }
    .status-message.error {
      background: var(--danger-soft);
      color: var(--danger);
    }
    .snippet-item {
      border: 1px solid var(--line);
      border-radius: 10px;
      background: var(--panel);
      padding: 10px;
      margin-bottom: 8px;
    }
    #snippetList {
      max-height: 250px;
      overflow-y: auto;
      padding-right: 2px;
    }
    .snippet-head {
      display: flex;
      justify-content: space-between;
      gap: 8px;
      align-items: center;
    }
    .snippet-item h3 {
      margin: 0;
      font-size: 0.92rem;
      word-break: break-word;
    }
    .snippet-item p {
      white-space: pre-wrap;
      word-break: break-word;
      margin: 6px 0;
      color: var(--text);
    }
    .tag {
      display: inline-block;
      margin: 0 6px 6px 0;
      padding: 2px 7px;
      border-radius: 999px;
      font-size: 0.73rem;
      color: var(--muted);
      background: var(--panel-soft);
      border: 1px solid var(--line);
    }
    .snippet-actions,
    .edit-actions {
      display: flex;
      gap: 6px;
      margin-top: 6px;
    }
    .snippet-content.collapsed {
      max-height: 4.7em;
      overflow: hidden;
      mask-image: linear-gradient(180deg, black 60%, transparent 100%);
      -webkit-mask-image: linear-gradient(180deg, black 60%, transparent 100%);
    }
    .read-more-btn {
      padding: 0;
      border: none;
      background: transparent;
      width: auto;
      color: var(--accent);
      font-size: 0.78rem;
      text-align: left;
    }
    .hidden {
      display: none !important;
    }
    .grid.two,
    .inline-actions {
      grid-template-columns: 1fr;
    }
    .toolbar {
      width: 100%;
      justify-content: flex-start;
    }
  </style>
</head>
<body>
  <div class="app">
    <header class="topbar">
      <div class="brand">
        <h1>Textorium</h1>
        <small data-i18n-text="header.localOnly">LOCAL ONLY</small>
      </div>
      <div class="toolbar">
        <select id="languageSelect" data-aria-key="aria.language" style="width:auto;">
          <option value="ja">æ—¥æœ¬èª</option>
          <option value="en">EN</option>
        </select>
        <button id="themeToggleBtn" class="btn-ghost" data-aria-key="aria.themeToggle" style="width:auto;">ğŸŒ™</button>
      </div>
    </header>

    <div id="statusMessage" class="status-message hidden" role="status" aria-live="polite"></div>

    <details class="section" open>
      <summary><span data-i18n-text="section.add">æ–°è¦ã‚¹ãƒ‹ãƒšãƒƒãƒˆ</span></summary>
      <div class="grid">
        <div class="grid">
          <label for="title" data-i18n-text="field.title">ã‚¿ã‚¤ãƒˆãƒ«</label>
          <input type="text" id="title" data-i18n-placeholder="placeholder.title" data-aria-key="aria.title" />
        </div>
        <div class="grid two">
          <div class="grid">
            <label for="tagName" data-i18n-text="field.tagName">ã‚¿ã‚°å</label>
            <input type="text" id="tagName" data-i18n-placeholder="placeholder.tagName" data-aria-key="aria.tagName" />
          </div>
          <div class="grid">
            <label for="tagCategory" data-i18n-text="field.tagCategory">ã‚«ãƒ†ã‚´ãƒª</label>
            <input type="text" id="tagCategory" data-i18n-placeholder="placeholder.tagCategory" data-aria-key="aria.tagCategory" />
          </div>
        </div>
        <div class="grid">
          <label for="content" data-i18n-text="field.content">æœ¬æ–‡</label>
          <textarea id="content" rows="4" data-i18n-placeholder="placeholder.content" data-aria-key="aria.content"></textarea>
        </div>
        <button id="saveSnippetBtn" class="btn-primary" data-i18n-text="action.saveSnippet" data-aria-key="aria.saveSnippet">ä¿å­˜</button>
      </div>
    </details>

    <section class="section">
      <h2 data-i18n-text="section.search">æ¤œç´¢ã¨ãƒ•ã‚£ãƒ«ã‚¿</h2>
      <div class="grid">
        <div class="grid two">
          <input type="text" id="searchInput" data-i18n-placeholder="placeholder.search" data-aria-key="aria.search" />
          <select id="filterTags" data-aria-key="aria.filterTag">
            <option value="" data-i18n-text="filter.allTags">ã™ã¹ã¦ã®ã‚¿ã‚°</option>
          </select>
        </div>
        <div class="inline-actions">
          <button id="searchBtn" data-i18n-text="action.search" data-aria-key="aria.searchButton">æ¤œç´¢</button>
          <button id="clearSearchBtn" data-i18n-text="action.clearSearch" data-aria-key="aria.clearSearch">æ¤œç´¢ã‚¯ãƒªã‚¢</button>
          <button id="filterFavoritesBtn" data-i18n-text="action.favoritesOnlyOff" data-aria-key="aria.favoritesOnly">ãŠæ°—ã«å…¥ã‚Š: OFF</button>
        </div>
        <button id="clearFilterBtn" class="btn-ghost" data-i18n-text="action.clearFilter" data-aria-key="aria.clearFilter">ãƒ•ã‚£ãƒ«ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆ</button>
      </div>
    </section>

    <section class="section">
      <h2 data-i18n-text="section.sort">ä¸¦ã³æ›¿ãˆ</h2>
      <div class="grid">
        <div class="grid two">
          <select id="sortBy" data-aria-key="aria.sortBy">
            <option value="createdAt" data-i18n-text="sort.createdAt">ä½œæˆæ—¥</option>
            <option value="updatedAt" data-i18n-text="sort.updatedAt">æ›´æ–°æ—¥</option>
            <option value="title" data-i18n-text="sort.title">ã‚¿ã‚¤ãƒˆãƒ«</option>
            <option value="favorite" data-i18n-text="sort.favorite">ãŠæ°—ã«å…¥ã‚Šå„ªå…ˆ</option>
          </select>
          <button id="sortDirection" data-aria-key="aria.sortDirection">â†“ Desc</button>
        </div>
        <button id="applySortBtn" data-i18n-text="action.applySort" data-aria-key="aria.applySort">é©ç”¨</button>
      </div>
    </section>

    <section class="section">
      <h2 data-i18n-text="section.list">ã‚¹ãƒ‹ãƒšãƒƒãƒˆä¸€è¦§</h2>
      <div id="snippetList"></div>
    </section>

    <details class="section">
      <summary><span data-i18n-text="section.transfer">ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—/å¾©å…ƒ</span></summary>
      <div class="grid">
        <button id="exportBtn" data-i18n-text="action.export" data-aria-key="aria.export">ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
        <div class="grid">
          <label for="importInput" data-i18n-text="field.import">JSONã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</label>
          <input type="file" id="importInput" accept="application/json" data-aria-key="aria.import" />
        </div>
      </div>
    </details>
  </div>

  <script src="utils.js"></script>
  <script src="snippet-domain.js"></script>
  <script src="i18n.js"></script>
  <script src="popup.js"></script>
</body>
</html>
